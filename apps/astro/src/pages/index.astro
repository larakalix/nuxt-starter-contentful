---
import Layout from "../layouts/Layout.astro";
import { FunnelPageSections } from "@starter/ui/pages";
import { getPageBySlug } from "@starter/content";
import { Error as ErrorComponent } from "@starter/ui/organisms";

const slug = "home";

const { funnelPage, error } = await (async () => {
    try {
        const funnelPage = await getPageBySlug(slug);
        if (!funnelPage)
            throw new Error(`Failed to load funnel page with slug: ${slug}`);

        return { funnelPage, error: null };
    } catch (err) {
        return { funnelPage: null, error: err as Error };
    }
})();
---

<Layout>
    {error && <ErrorComponent message={error?.message} />}

    <FunnelPageSections funnelPage={funnelPage} />
</Layout>
